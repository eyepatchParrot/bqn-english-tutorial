Tan â† â€¢math.Tan
wâ€¿hâ€¿fov â† 10â€¿7â€¿(Ï€Ã·2)
c â† âŸ¨âŸ¨ 0.2, 0.7, 0.8 âŸ©   # background
     âŸ¨ 0.4, 0.4, 0.3 âŸ©âŸ©  # foreground
lâ€¿r2 â† âŸ¨ Â¯3,0,Â¯16 âŸ©â€¿(Ã—Ëœ2)

xâ€¿y â† âŸ¨ hÃ·ËœwÃ—(Tan fovÃ·2)Ã—  -âŸœ1 Ã·âŸœw 2Ã—0.5+ hâ€¿wâ¥Šâ†•w
             (Tan fovÃ·2)Ã—- -âŸœ1 Ã·âŸœh 2Ã—0.5+â‰wâ€¿hâ¥Šâ†•h âŸ©
dd â† xâˆ¾yâ‰(hâ€¿w â¥ŠÂ¯1)       # dirs de-normalized
dn â† Ã·âˆš+ËÃ—Ëœ dd           # dirs norm factor
t â† +ËlÃ— Ã—âŸœdnâ‰(=dn) dd
d2 â† r2<l+ËâŠ¸-âŸœâŠ¢â—‹(Ã—Ëœ) t
framebuffer â† âŠ‘âŸœcÂ¨ Â¬d2 âˆ¨ t (-âˆ¨â—‹(<âŸœ0)+) âˆšr2-d2

# _a â† {ğ•© ğ”½â‰(= ğ•©) ğ•¨}
# dd Ã— _a dn
